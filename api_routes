from flask import Blueprint, jsonify, request
from flask_jwt_extended import jwt_required

from api import APICalls

api_bp = Blueprint('api_bp', __name__)
apiService = APICalls()

@api_bp.route('/', defaults={'path': ''})
@api_bp.route('/<path:path>')
@jwt_required()
def api_base(path):
    return jsonify({"message": "API base route"}), 200

@api_bp.route('/getTeacherlessLearners')
@jwt_required()
def getTeacherLessLearnersView():
    TeacherCode = request.args.get('TeacherCode')
    Day = int(request.args.get('Day'))
    return jsonify(apiService.getTeacherlessLearners(TeacherCode, Day))

@api_bp.route('/getAbsentTeachers')
@jwt_required()
def getAbsentTeachersView():
    return jsonify(apiService.getAbsentTeachers())

@api_bp.route('/setAbsentTeacher')
@jwt_required()
def setAbsentTeacherView():
    TeacherCode = request.args.get('TeacherCode')
    Day = int(request.args.get('Day'))
    return jsonify(apiService.setAbsentTeacher(TeacherCode, Day))